# Intro (Web)

In tangled webs of code we weave, JavaScript whispers, making pages breathe, Turning static dreams into worlds that live.

---

The challenged provided `index.html`

```html
<!doctype html>
...
<script>
(function(){

// You can skip this part, thereâ€™s an easier way:
const G=V;(function(k,I){const y=V;const d=k();while(!![]){try{const c=-parseInt(y(0x1ce))/(-0x8c4*0x2+-0x992+0x101*0x1b)+-parseInt(y(0x1d4))/(-0xacf*0x1+0x103d*-0x1+0xd87*0x2)+-parseInt(y(0x1e4))/(0xa9f+0x1*0x1c57+0xd*-0x2ff)+-parseInt(y(0x1d0))/(-0x83*-0x1+-0x232d+-0x1*-0x22ae)+-parseInt(y(0x1f4))/(0x5*-0x5c9+-0xb91+0x2883)+parseInt(y(0x1e1))/(-0x1eb9+0x457*0x3+0x1*0x11ba)+parseInt(y(0x1e5))/(-0x17*0xad+-0x5*-0x184+0x7fe);if(c===I){break;}else{d['push'](d['shift']());}}catch(z){d['push'](d['shift']());}}}(w,-0x303*-0x13d+-0x1*0x1fd6b+-0x1352f*-0x1));const n=(function(){let k=!![];return function(I,d){const c=k?function(){const S=V;if(S(0x1d7)===S(0x1e3)){return!![];}else{if(d){const W=d[S(0x1d8)](I,arguments);d=null;return W;}}}:function(){};k=![];return c;};}());function V(F,q){const m=w();V=function(n,k){n=n-(0x59e*-0x2+-0x8*0x16a+0x1857*0x1);let I=m[n];return I;};return V(F,q);}const m=n(this,function(){const t=V;return m[t(0x1ee)]()[t(0x1d3)]('\x28\x28\x28\x2e\x2b\x29\x2b\x29\x2b\x29\x2b\x24')[t(0x1ee)]()['\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72'](m)[t(0x1d3)](t(0x1e2));});function w(){const r=['\x33\x34\x32\x32\x36\x31\x50\x59\x50\x7a\x4d\x6c','\x38\x35\x37\x34\x33\x39\x38\x56\x58\x6f\x72\x6f\x4a','\x63\x61\x6c\x6c','\x53\x62\x6a\x6c\x61','\x69\x6e\x69\x74','\x58\x47\x48\x53\x71','\x7b\x7d\x2e\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72\x28\x22\x72\x65\x74\x75\x72\x6e\x20\x74\x68\x69\x73\x22\x29\x28\x20\x29','\x76\x75\x66\x51\x43','\x63\x68\x61\x69\x6e','\x61\x63\x74\x69\x6f\x6e','\x74\x6f\x53\x74\x72\x69\x6e\x67','\x43\x4f\x4f\x50\x73','\x72\x65\x74\x75\x72\x6e\x20\x28\x66\x75\x6e\x63\x74\x69\x6f\x6e\x28\x29\x20','\x67\x67\x65\x72','\x77\x68\x69\x6c\x65\x20\x28\x74\x72\x75\x65\x29\x20\x7b\x7d','\x4e\x54\x52\x74\x6f','\x31\x34\x37\x34\x31\x34\x35\x71\x64\x78\x6d\x65\x6a','\x51\x41\x44\x51\x4d','\x5c\x2b\x5c\x2b\x20\x2a\x28\x3f\x3a\x5b\x61\x2d\x7a\x41\x2d\x5a\x5f\x24\x5d\x5b\x30\x2d\x39\x61\x2d\x7a\x41\x2d\x5a\x5f\x24\x5d\x2a\x29','\x66\x72\x6f\x6d','\x31\x39\x39\x36\x33\x32\x6a\x63\x73\x6b\x51\x59','\x66\x72\x6f\x6d\x43\x68\x61\x72\x43\x6f\x64\x65','\x39\x38\x32\x31\x35\x32\x52\x56\x75\x42\x72\x4c','\x64\x65\x62\x75','\x44\x54\x4b\x66\x7a','\x73\x65\x61\x72\x63\x68','\x37\x35\x35\x32\x37\x30\x58\x63\x64\x48\x41\x52','\x56\x46\x6c\x4f\x6c','\x6c\x65\x6e\x67\x74\x68','\x4c\x49\x48\x50\x51','\x61\x70\x70\x6c\x79','\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72','\x69\x6e\x70\x75\x74','\x66\x75\x6e\x63\x74\x69\x6f\x6e\x20\x2a\x5c\x28\x20\x2a\x5c\x29','\x6d\x61\x70','\x73\x74\x61\x74\x65\x4f\x62\x6a\x65\x63\x74','\x51\x48\x54\x5a\x41','\x73\x65\x74\x49\x6e\x74\x65\x72\x76\x61\x6c','\x74\x65\x73\x74','\x31\x31\x39\x39\x37\x32\x34\x74\x43\x75\x71\x6f\x47','\x28\x28\x28\x2e\x2b\x29\x2b\x29\x2b\x29\x2b\x24','\x4e\x6e\x42\x58\x55'];w=function(){return r;};return w();}m();const q=(function(){let k=!![];return function(I,d){const c=k?function(){if(d){const z=d['\x61\x70\x70\x6c\x79'](I,arguments);d=null;return z;}}:function(){};k=![];return c;};}());(function(){q(this,function(){const Q=V;if(Q(0x1d2)==='\x44\x54\x4b\x66\x7a'){const k=new RegExp(Q(0x1db));const I=new RegExp('\x5c\x2b\x5c\x2b\x20\x2a\x28\x3f\x3a\x5b\x61\x2d\x7a\x41\x2d\x5a\x5f\x24\x5d\x5b\x30\x2d\x39\x61\x2d\x7a\x41\x2d\x5a\x5f\x24\x5d\x2a\x29','\x69');const d=F(Q(0x1e8));if(!k[Q(0x1e0)](d+Q(0x1ec))||!I[Q(0x1e0)](d+'\x69\x6e\x70\x75\x74')){if('\x51\x41\x44\x51\x4d'===Q(0x1cb)){d('\x30');}else{return d[Q(0x1ee)]()['\x73\x65\x61\x72\x63\x68'](Q(0x1e2))['\x74\x6f\x53\x74\x72\x69\x6e\x67']()['\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72'](c)[Q(0x1d3)]('\x28\x28\x28\x2e\x2b\x29\x2b\x29\x2b\x29\x2b\x24');}}else{F();}}else{return I;}})();}());const KEY=Uint8Array[G(0x1cd)]([-0x1a3+-0x1*-0x371+-0x1bb*0x1,-0x2652+0x1*0x1393+0x12f6,-0x7b5*0x2+0x642+0x9e8,0x1*-0x509+0x21bd*0x1+-0x1bd6]);const ENC=Uint8Array[G(0x1cd)]([-0x191c+0x2b0*0x5+0xc01,0x1e04+-0x1630*-0x1+-0x4*0xcf7,0x2*0x6d1+-0x338+-0x9b8,-0x4e*-0x11+-0xc2b+0x7a7,0xd70+0xc*-0x1bd+0x7c6,-0x5*-0x4b9+-0x1fb0+-0x886*-0x1,-0x6e7*-0x1+-0x1886+0x125a,-0x886*0x3+0x23c8+0x94d*-0x1,0x94d*-0x1+0xe5c+-0x494,-0x25a9+-0x1*0x1a5d+0x4064,0x26c0+-0x23*-0x103+0x4*-0x124d,0x28*0xc1+0x1074+-0x2e1b,-0x557*0x1+-0x1*0x10f3+0xb62*0x2,-0x1247*-0x2+0x2*0x412+0xb2c*-0x4,-0x265*-0x1+0xb46+-0xd0c,0xccb*0x3+0x19f*0x3+-0xb*0x3df,0x14bd+-0xd*-0x2f5+-0x3b0e,-0x1729+0xaa3+0xcdb*0x1,0x34*0x7c+-0x265d+0xdcc,0x31*0x6b+0x1d2c*0x1+-0x1*0x30ef,0x3c9+0x42b*0x1+-0x7d1,-0xa8d+-0x34d*-0x1+-0x181*-0x5,0x1*-0xc7c+-0xb*-0x9+0xcb8,0x8ce+-0x12b*0x11+0xbb6,-0x65*-0x38+0x2*-0xeae+-0x1*-0x76b,-0x2646+-0x14ef+0x3b7a,-0x321*0x1+0xbfc+-0x82e,-0x245*0x9+-0x203e+-0x1a96*-0x2,-0xd7a+0x2204+-0x4*0x509,-0x92c+0xf6*-0x6+-0x5*-0x30b,-0x6ce+-0x21ce+0x2959]);const DEC=new Uint8Array(ENC['\x6c\x65\x6e\x67\x74\x68']);for(let i=0x1e97+0x143c+-0x32d3;i<ENC[G(0x1d6)];i++){DEC[i]=ENC[i]^KEY[i%KEY[G(0x1d6)]];}const FLAG=typeof TextDecoder!=='\x75\x6e\x64\x65\x66\x69\x6e\x65\x64'?new TextDecoder()['\x64\x65\x63\x6f\x64\x65'](DEC):Array[G(0x1cd)](DEC)[G(0x1dc)](k=>String[G(0x1cf)](k))['\x6a\x6f\x69\x6e']('');function F(k){const M=G;function I(d){const R=V;if(typeof d==='\x73\x74\x72\x69\x6e\x67'){if(R(0x1f3)===R(0x1f3)){return function(c){}[R(0x1d9)](R(0x1f2))[R(0x1d8)]('\x63\x6f\x75\x6e\x74\x65\x72');}else{const z=new z(R(0x1db));const W=new W(R(0x1cc),'\x69');const o=o(R(0x1e8));if(!z[R(0x1e0)](o+R(0x1ec))||!W['\x74\x65\x73\x74'](o+R(0x1da))){o('\x30');}else{l();}}}else{if(R(0x1e7)==='\x53\x62\x6a\x6c\x61'){if((''+d/d)[R(0x1d6)]!==0x2c*-0xc9+0x2a9+-0x34*-0x9d||d%(-0x1697*-0x1+-0x1*0x3f7+0x128c*-0x1)===-0x2c*-0x56+-0x1510+0x43*0x18){if(R(0x1d5)===R(0x1d5)){(function(){return!![];}[R(0x1d9)](R(0x1d1)+'\x67\x67\x65\x72')[R(0x1e6)](R(0x1ed)));}else{d=c(R(0x1f0)+R(0x1ea)+'\x29\x3b')();}}else{(function(){return![];}[R(0x1d9)]('\x64\x65\x62\x75'+R(0x1f1))['\x61\x70\x70\x6c\x79'](R(0x1dd)));}}else{I('\x30');}}I(++d);}try{if(k){if(M(0x1ef)===M(0x1e9)){const c=function(){const J=M;let a;try{a=l(J(0x1f0)+'\x7b\x7d\x2e\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72\x28\x22\x72\x65\x74\x75\x72\x6e\x20\x74\x68\x69\x73\x22\x29\x28\x20\x29'+'\x29\x3b')();}catch(b){a=s;}return a;};const z=c();z[M(0x1df)](W,0x15*-0x3e+0x1f82+-0x1684);}else{return I;}}else{if('\x52\x58\x70\x59\x48'!==M(0x1eb)){I(0x8*-0x4bc+-0x1e46+-0x11e*-0x3d);}else{const z=o?function(){const x=M;if(z){const e=Z[x(0x1d8)](p,arguments);f=null;return e;}}:function(){};O=![];return z;}}}catch(z){}}(function(){const U=G;const k=function(){const B=V;let d;try{if(B(0x1de)===B(0x1de)){d=Function(B(0x1f0)+B(0x1ea)+'\x29\x3b')();}else{I();}}catch(z){d=window;}return d;};const I=k();I[U(0x1df)](F,0xd*0x17b+0x1*0x20da+-0x3031);}());

...
</script>
```

# Solution

Overall, we can see a really suspicious `<script>` tag, which include a very long JavaScript code. And because the code is obfuscated, we shoud deobfuscated for flag. First, just beautify the code.

There are some classic signs of obfuscation in the code.

- String mapping function pair: `w()`, `V()`, `G()` with array shifting while loop.

- Multiple `IIFEs` (self-executing functions), nested `try/catch`

- Anti-debug style: use `Function('debugger')`, regex check, `setInterval(F, ...)` spam check.

Skip all that. Then straight down near the end, we will see the core:

```javascript
const KEY=Uint8Array[... ]([ ... ]);
const ENC=Uint8Array[... ]([ ... ]);
const DEC=new Uint8Array(ENC.length);
for(let i=0;i<ENC.length;i++){
  DEC[i]=ENC[i]^KEY[i%KEY.length];
}
const FLAG = (new TextDecoder()).decode(DEC);
```

In the original code, the elements of `KEY/ENC` have the form of hexadecimal/negative operations of the type:

```
-0x1a3+0x371-0x1bb
```

All of them are constant. I used ChatGPT for calculating it all. Or if you want to calculate them yourself, just put it into the Console tab, for example `-0x1a3+0x371-0x1bb` got `19`. Repeat that for all of the elements, we got

```js
KEY = [19, 55, 192, 222];
ENC = [85,88,178,170,90,115,187,233,123,94,245,129,122,2,159,169,32,85,159,184,35,69,159,169,39,69,173,129,102,71,189];
```

Finally, write a simple script to decode them and get flag

```javascript
const KEY = [19, 55, 192, 222];
const ENC = [85,88,178,170,90,115,187,233,123,94,245,129,122,2,159,169,32,85,159,184,35,69,159,169,39,69,173,129,102,71,189];

const DEC = ENC.map((b,i)=> b ^ KEY[i % KEY.length]);
console.log(new TextDecoder().decode(new Uint8Array(DEC)));
// -> FortID{7hi5_i5_w3b_f0r_w4rm_up}
```

Bonus: Python script

```python
KEY = [19, 55, 192, 222]
ENC = [85,88,178,170,90,115,187,233,123,94,245,129,122,2,159,169,32,85,159,184,35,69,159,169,39,69,173,129,102,71,189]
DEC = bytes([b ^ KEY[i % len(KEY)] for i,b in enumerate(ENC)])
print(DEC.decode())
# FortID{7hi5_i5_w3b_f0r_w4rm_up}
```

# Flag: `FortID{7hi5_i5_w3b_f0r_w4rm_up}`
